<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Note 3 RH134 | Training notes : Linux, Devops, entre outros</title>
  <meta name="description" content="Those notes are for future reference" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Note 3 RH134 | Training notes : Linux, Devops, entre outros" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Those notes are for future reference" />
  <meta name="github-repo" content="rstudio/book-notes-linux-learn" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Note 3 RH134 | Training notes : Linux, Devops, entre outros" />
  
  <meta name="twitter:description" content="Those notes are for future reference" />
  

<meta name="author" content="Bruno Machado" />


<meta name="date" content="2021-10-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r124.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Learning Linux Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Intro</a></li>
<li class="chapter" data-level="2" data-path="r124.html"><a href="r124.html"><i class="fa fa-check"></i><b>2</b> R124</a><ul>
<li class="chapter" data-level="2.1" data-path="r124.html"><a href="r124.html#what-is-linux"><i class="fa fa-check"></i><b>2.1</b> What is linux ?</a></li>
<li class="chapter" data-level="2.2" data-path="r124.html"><a href="r124.html#command-line"><i class="fa fa-check"></i><b>2.2</b> Command Line</a><ul>
<li class="chapter" data-level="2.2.1" data-path="r124.html"><a href="r124.html#and"><i class="fa fa-check"></i><b>2.2.1</b> <code>$</code> and <code>#</code></a></li>
<li class="chapter" data-level="2.2.2" data-path="r124.html"><a href="r124.html#to-login-into-another-computer-using-ssh"><i class="fa fa-check"></i><b>2.2.2</b> To login into another computer using <code>ssh</code></a></li>
<li class="chapter" data-level="2.2.3" data-path="r124.html"><a href="r124.html#executing-commands"><i class="fa fa-check"></i><b>2.2.3</b> Executing commands</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="r124.html"><a href="r124.html#managing-file-system"><i class="fa fa-check"></i><b>2.3</b> Managing File system</a><ul>
<li class="chapter" data-level="2.3.1" data-path="r124.html"><a href="r124.html#the-file-system-hierarchy"><i class="fa fa-check"></i><b>2.3.1</b> The file system hierarchy <code>/</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="r124.html"><a href="r124.html#absolute-and-relative-paths"><i class="fa fa-check"></i><b>2.3.2</b> Absolute and Relative paths</a></li>
<li class="chapter" data-level="2.3.3" data-path="r124.html"><a href="r124.html#managing-files"><i class="fa fa-check"></i><b>2.3.3</b> Managing Files</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="r124.html"><a href="r124.html#help"><i class="fa fa-check"></i><b>2.4</b> Help</a></li>
<li class="chapter" data-level="2.5" data-path="r124.html"><a href="r124.html#text-files"><i class="fa fa-check"></i><b>2.5</b> Text Files</a><ul>
<li class="chapter" data-level="2.5.1" data-path="r124.html"><a href="r124.html#vim"><i class="fa fa-check"></i><b>2.5.1</b> vim</a></li>
<li class="chapter" data-level="2.5.2" data-path="r124.html"><a href="r124.html#changing-shell"><i class="fa fa-check"></i><b>2.5.2</b> Changing shell</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="r124.html"><a href="r124.html#managing-local-users-and-groups"><i class="fa fa-check"></i><b>2.6</b> Managing Local Users and Groups</a><ul>
<li class="chapter" data-level="2.6.1" data-path="r124.html"><a href="r124.html#users"><i class="fa fa-check"></i><b>2.6.1</b> Users</a></li>
<li class="chapter" data-level="2.6.2" data-path="r124.html"><a href="r124.html#groups"><i class="fa fa-check"></i><b>2.6.2</b> Groups</a></li>
<li class="chapter" data-level="2.6.3" data-path="r124.html"><a href="r124.html#gaining-superuser-access"><i class="fa fa-check"></i><b>2.6.3</b> Gaining superuser access</a></li>
<li class="chapter" data-level="2.6.4" data-path="r124.html"><a href="r124.html#managing-user-passwords"><i class="fa fa-check"></i><b>2.6.4</b> Managing user passwords</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="r124.html"><a href="r124.html#controlling-access-to-files"><i class="fa fa-check"></i><b>2.7</b> Controlling access to files</a><ul>
<li class="chapter" data-level="2.7.1" data-path="r124.html"><a href="r124.html#default-permissions"><i class="fa fa-check"></i><b>2.7.1</b> Default permissions</a></li>
<li class="chapter" data-level="2.7.2" data-path="r124.html"><a href="r124.html#umask"><i class="fa fa-check"></i><b>2.7.2</b> umask</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="r124.html"><a href="r124.html#monitoring-and-managing-linux-process"><i class="fa fa-check"></i><b>2.8</b> Monitoring and MAnaging Linux process</a><ul>
<li class="chapter" data-level="2.8.1" data-path="r124.html"><a href="r124.html#commands-to-monitor"><i class="fa fa-check"></i><b>2.8.1</b> Commands to monitor</a></li>
<li class="chapter" data-level="2.8.2" data-path="r124.html"><a href="r124.html#controlling-jobs"><i class="fa fa-check"></i><b>2.8.2</b> Controlling jobs</a></li>
<li class="chapter" data-level="2.8.3" data-path="r124.html"><a href="r124.html#killing-process"><i class="fa fa-check"></i><b>2.8.3</b> Killing process</a></li>
<li class="chapter" data-level="2.8.4" data-path="r124.html"><a href="r124.html#monitor-process-activity"><i class="fa fa-check"></i><b>2.8.4</b> Monitor process activity</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="r124.html"><a href="r124.html#controlling-services-and-daemons"><i class="fa fa-check"></i><b>2.9</b> Controlling Services and Daemons</a></li>
<li class="chapter" data-level="2.10" data-path="r124.html"><a href="r124.html#configuring-and-securing-ssh"><i class="fa fa-check"></i><b>2.10</b> Configuring and Securing SSH</a><ul>
<li class="chapter" data-level="2.10.1" data-path="r124.html"><a href="r124.html#configure-ssh-key-based-authentication"><i class="fa fa-check"></i><b>2.10.1</b> Configure SSH Key-based Authentication</a></li>
<li class="chapter" data-level="2.10.2" data-path="r124.html"><a href="r124.html#create-a-public-and-private-keypair"><i class="fa fa-check"></i><b>2.10.2</b> Create a public and private keypair</a></li>
<li class="chapter" data-level="2.10.3" data-path="r124.html"><a href="r124.html#customizing-openssh-service-config"><i class="fa fa-check"></i><b>2.10.3</b> Customizing OpenSSH Service Config</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="r124.html"><a href="r124.html#analysing-and-storing-logs"><i class="fa fa-check"></i><b>2.11</b> Analysing and Storing Logs</a><ul>
<li class="chapter" data-level="2.11.1" data-path="r124.html"><a href="r124.html#reviewing-system-hournal-entries"><i class="fa fa-check"></i><b>2.11.1</b> Reviewing System Hournal Entries</a></li>
<li class="chapter" data-level="2.11.2" data-path="r124.html"><a href="r124.html#preserving-the-system-journal"><i class="fa fa-check"></i><b>2.11.2</b> Preserving the system journal</a></li>
<li class="chapter" data-level="2.11.3" data-path="r124.html"><a href="r124.html#maitaining-accurate-time"><i class="fa fa-check"></i><b>2.11.3</b> Maitaining Accurate time</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="r124.html"><a href="r124.html#managing-networking"><i class="fa fa-check"></i><b>2.12</b> Managing Networking</a><ul>
<li class="chapter" data-level="2.12.1" data-path="r124.html"><a href="r124.html#tcpip"><i class="fa fa-check"></i><b>2.12.1</b> TCPIP</a></li>
<li class="chapter" data-level="2.12.2" data-path="r124.html"><a href="r124.html#validating-network-configuration"><i class="fa fa-check"></i><b>2.12.2</b> Validating Network Configuration</a></li>
<li class="chapter" data-level="2.12.3" data-path="r124.html"><a href="r124.html#configure-networking-from-the-command-line"><i class="fa fa-check"></i><b>2.12.3</b> Configure Networking from the Command Line</a></li>
<li class="chapter" data-level="2.12.4" data-path="r124.html"><a href="r124.html#editing-network-configuration-files"><i class="fa fa-check"></i><b>2.12.4</b> Editing Network Configuration Files</a></li>
<li class="chapter" data-level="2.12.5" data-path="r124.html"><a href="r124.html#configuring-hot-names-and-name-resolution"><i class="fa fa-check"></i><b>2.12.5</b> Configuring Hot Names and Name Resolution</a></li>
</ul></li>
<li class="chapter" data-level="2.13" data-path="r124.html"><a href="r124.html#archiving-and-transferring-files"><i class="fa fa-check"></i><b>2.13</b> Archiving and transferring files</a><ul>
<li class="chapter" data-level="2.13.1" data-path="r124.html"><a href="r124.html#tar"><i class="fa fa-check"></i><b>2.13.1</b> TAR</a></li>
<li class="chapter" data-level="2.13.2" data-path="r124.html"><a href="r124.html#scp"><i class="fa fa-check"></i><b>2.13.2</b> SCP</a></li>
<li class="chapter" data-level="2.13.3" data-path="r124.html"><a href="r124.html#sftp"><i class="fa fa-check"></i><b>2.13.3</b> SFTP</a></li>
<li class="chapter" data-level="2.13.4" data-path="r124.html"><a href="r124.html#synchronizing-files-between-system"><i class="fa fa-check"></i><b>2.13.4</b> Synchronizing Files Between System</a></li>
</ul></li>
<li class="chapter" data-level="2.14" data-path="r124.html"><a href="r124.html#intalling-and-updating-software-packages"><i class="fa fa-check"></i><b>2.14</b> Intalling and updating software packages</a><ul>
<li class="chapter" data-level="2.14.1" data-path="r124.html"><a href="r124.html#package-manager"><i class="fa fa-check"></i><b>2.14.1</b> Package manager</a></li>
<li class="chapter" data-level="2.14.2" data-path="r124.html"><a href="r124.html#inslalling-and-update-software-packages-with-yum"><i class="fa fa-check"></i><b>2.14.2</b> Inslalling and Update Software Packages with <strong>Yum</strong></a></li>
<li class="chapter" data-level="2.14.3" data-path="r124.html"><a href="r124.html#enabling-yum-software-repositories"><i class="fa fa-check"></i><b>2.14.3</b> Enabling Yum Software Repositories</a></li>
<li class="chapter" data-level="2.14.4" data-path="r124.html"><a href="r124.html#managing-packages-module-streams"><i class="fa fa-check"></i><b>2.14.4</b> Managing Packages Module Streams</a></li>
</ul></li>
<li class="chapter" data-level="2.15" data-path="r124.html"><a href="r124.html#accessing-linux-file-systems"><i class="fa fa-check"></i><b>2.15</b> Accessing Linux File Systems</a><ul>
<li class="chapter" data-level="2.15.1" data-path="r124.html"><a href="r124.html#mount-and-unmounting-file-systems"><i class="fa fa-check"></i><b>2.15.1</b> Mount and Unmounting File systems</a></li>
<li class="chapter" data-level="2.15.2" data-path="r124.html"><a href="r124.html#locating-files-on-the-system"><i class="fa fa-check"></i><b>2.15.2</b> Locating Files on the System</a></li>
</ul></li>
<li class="chapter" data-level="2.16" data-path="r124.html"><a href="r124.html#analysing-server-and-getting-support"><i class="fa fa-check"></i><b>2.16</b> Analysing Server and Getting Support</a><ul>
<li class="chapter" data-level="2.16.1" data-path="r124.html"><a href="r124.html#deteting-and-resolving-issues-with-red-hat-insights"><i class="fa fa-check"></i><b>2.16.1</b> Deteting and Resolving issues with Red Hat Insights</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="rh134.html"><a href="rh134.html"><i class="fa fa-check"></i><b>3</b> RH134</a><ul>
<li class="chapter" data-level="3.1" data-path="rh134.html"><a href="rh134.html#improving-command-line-productivity"><i class="fa fa-check"></i><b>3.1</b> Improving Command Line Productivity</a></li>
<li class="chapter" data-level="3.2" data-path="rh134.html"><a href="rh134.html#scheduling-future-tasks"><i class="fa fa-check"></i><b>3.2</b> Scheduling Future Tasks</a></li>
<li class="chapter" data-level="3.3" data-path="rh134.html"><a href="rh134.html#tuning-system-performance"><i class="fa fa-check"></i><b>3.3</b> Tuning System Performance</a><ul>
<li class="chapter" data-level="3.3.1" data-path="rh134.html"><a href="rh134.html#profiles"><i class="fa fa-check"></i><b>3.3.1</b> Profiles</a></li>
<li class="chapter" data-level="3.3.2" data-path="rh134.html"><a href="rh134.html#managing-profiles-from-command-line"><i class="fa fa-check"></i><b>3.3.2</b> Managing profiles from command line</a></li>
<li class="chapter" data-level="3.3.3" data-path="rh134.html"><a href="rh134.html#influencing-process-scheduling"><i class="fa fa-check"></i><b>3.3.3</b> Influencing Process Scheduling</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="rh134.html"><a href="rh134.html#controling-access-to-files-with-acls"><i class="fa fa-check"></i><b>3.4</b> Controling Access to Files with ACLs</a></li>
<li class="chapter" data-level="3.5" data-path="rh134.html"><a href="rh134.html#managing-selinux-security"><i class="fa fa-check"></i><b>3.5</b> Managing SELinux Security</a><ul>
<li class="chapter" data-level="3.5.1" data-path="rh134.html"><a href="rh134.html#controlling-selinux-file-contexts"><i class="fa fa-check"></i><b>3.5.1</b> Controlling SELinux File Contexts</a></li>
<li class="chapter" data-level="3.5.2" data-path="rh134.html"><a href="rh134.html#adjusting-selinux-policy-with-booleans"><i class="fa fa-check"></i><b>3.5.2</b> Adjusting SELinux Policy with Booleans</a></li>
<li class="chapter" data-level="3.5.3" data-path="rh134.html"><a href="rh134.html#investigating-and-resolving-selinux-issues"><i class="fa fa-check"></i><b>3.5.3</b> Investigating and REsolving SELinux issues</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="rh134.html"><a href="rh134.html#managing-basic-storage"><i class="fa fa-check"></i><b>3.6</b> Managing Basic Storage</a><ul>
<li class="chapter" data-level="3.6.1" data-path="rh134.html"><a href="rh134.html#adding-partition-file-systems-and-persistent-mounts"><i class="fa fa-check"></i><b>3.6.1</b> Adding Partition, File Systems and Persistent Mounts</a></li>
<li class="chapter" data-level="3.6.2" data-path="rh134.html"><a href="rh134.html#managing-swap-space"><i class="fa fa-check"></i><b>3.6.2</b> Managing Swap Space</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="rh134.html"><a href="rh134.html#managing-logical-volumes"><i class="fa fa-check"></i><b>3.7</b> Managing Logical Volumes</a><ul>
<li class="chapter" data-level="3.7.1" data-path="rh134.html"><a href="rh134.html#creating-logical-volumes"><i class="fa fa-check"></i><b>3.7.1</b> Creating Logical Volumes</a></li>
<li class="chapter" data-level="3.7.2" data-path="rh134.html"><a href="rh134.html#extending-and-reducing-logical-volumes"><i class="fa fa-check"></i><b>3.7.2</b> Extending and Reducing Logical Volumes</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="rh134.html"><a href="rh134.html#implementing-advanced-storage-features"><i class="fa fa-check"></i><b>3.8</b> Implementing Advanced Storage Features</a><ul>
<li class="chapter" data-level="3.8.1" data-path="rh134.html"><a href="rh134.html#managing-storage-with-stratis"><i class="fa fa-check"></i><b>3.8.1</b> Managing Storage with Stratis</a></li>
<li class="chapter" data-level="3.8.2" data-path="rh134.html"><a href="rh134.html#compressing-and-deduplicating-storage-with-vdo"><i class="fa fa-check"></i><b>3.8.2</b> Compressing and Deduplicating Storage with VDO</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="rh134.html"><a href="rh134.html#accessing-network-attached-storage"><i class="fa fa-check"></i><b>3.9</b> Accessing Network-Attached Storage</a><ul>
<li class="chapter" data-level="3.9.1" data-path="rh134.html"><a href="rh134.html#mounting-network-attached-storage-with-nfs"><i class="fa fa-check"></i><b>3.9.1</b> Mounting Network-Attached Storage with NFS</a></li>
<li class="chapter" data-level="3.9.2" data-path="rh134.html"><a href="rh134.html#automounting-network-attached-storage"><i class="fa fa-check"></i><b>3.9.2</b> Automounting Network-Attached Storage</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="rh134.html"><a href="rh134.html#controlling-the-boot-process"><i class="fa fa-check"></i><b>3.10</b> Controlling The Boot Process</a><ul>
<li class="chapter" data-level="3.10.1" data-path="rh134.html"><a href="rh134.html#selecting-the-boot-target"><i class="fa fa-check"></i><b>3.10.1</b> Selecting the boot target</a></li>
<li class="chapter" data-level="3.10.2" data-path="rh134.html"><a href="rh134.html#resetting-the-root-password"><i class="fa fa-check"></i><b>3.10.2</b> Resetting the Root Password</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="4" data-path="devops.html"><a href="devops.html"><i class="fa fa-check"></i><b>4</b> DevOps</a><ul>
<li class="chapter" data-level="4.1" data-path="devops.html"><a href="devops.html#azure"><i class="fa fa-check"></i><b>4.1</b> Azure</a></li>
<li class="chapter" data-level="4.2" data-path="devops.html"><a href="devops.html#aws"><i class="fa fa-check"></i><b>4.2</b> AWS</a></li>
<li class="chapter" data-level="4.3" data-path="devops.html"><a href="devops.html#docker"><i class="fa fa-check"></i><b>4.3</b> Docker</a><ul>
<li class="chapter" data-level="4.3.1" data-path="devops.html"><a href="devops.html#part-1"><i class="fa fa-check"></i><b>4.3.1</b> Part 1</a></li>
<li class="chapter" data-level="4.3.2" data-path="devops.html"><a href="devops.html#part-2"><i class="fa fa-check"></i><b>4.3.2</b> Part 2</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Training notes : Linux, Devops, entre outros</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rh134" class="section level1">
<h1><span class="header-section-number">Note 3</span> RH134</h1>
<div id="improving-command-line-productivity" class="section level2">
<h2><span class="header-section-number">3.1</span> Improving Command Line Productivity</h2>
<p><strong>Writing Simple Bash Scripts</strong></p>
<p>The Bash interpreter start in the first line of script with <strong>#! /bin/bash</strong> and to run the script we need :</p>
<ol style="list-style-type: decimal">
<li><p>Config the execute permission on script</p></li>
<li><p>Have the script on <code>$HOME/bin</code> and call the script name or any other bin path inside your <code>$PATH</code></p></li>
</ol>
<p><strong>LOOPS</strong></p>
<p><em>Syntax</em> of bash <strong>for loop</strong></p>
<pre><code>for &lt;VARIABLE&gt; in &lt;LIST&gt;; do
&lt;COMMAND&gt; &lt;VARIABLE&gt;
done</code></pre>
<p>Sample:</p>
<pre><code>#1 
for HOST in host1 host2 host3; do echo $HOST; done

#2
for HOST in host{1,2,3}; do echo $HOST; done


#3
for HOST in host{1..3}; do echo $HOST; done

#4
for FILE in file* ; do ls $FILE; done

#5
for FILE in file{a..c}; do ls $FILE; done

#6
for PACKAGE in $(rpm -qa | grep kernel); \
do echo &quot;$PACKAGE was installed on \
$(date -d @$(rpm -q -qqf &quot;%{INSTALLTIME} \n&quot; $PACKAGE))&quot;; done
</code></pre>
<p><strong>Sequence</strong></p>
<p>Sample :</p>
<pre><code>#1
seq 2 2 10

output
2
4
6
8
10


#2
for EVEN in $(seq 2 2 10); do &quot;$EVEN&quot;;done</code></pre>
<p><strong>Exit Codes</strong></p>
<ul>
<li><p>0 : successfully</p></li>
<li><blockquote>
<p>0 : not successfully</p>
</blockquote></li>
<li><p>0 to 255 : range</p></li>
<li><p>To display the exit code</p></li>
</ul>
<pre><code>echo $?</code></pre>
<p><strong>IF / THEN</strong></p>
<pre><code>
#1
if &lt;condition&gt;; then
    &lt;STATEMENT&gt;
    ...
    &lt;STATEMENT&gt;
  else
    &lt;STATEMENT&gt;
    ...
    &lt;STATEMENT&gt;
fi



#2
if &lt;condition&gt;; then
    &lt;STATEMENT&gt;
    ...
    &lt;STATEMENT&gt;
  elif &lt;condition&gt;; then
    &lt;STATEMENT&gt;
    ...
    &lt;STATEMENT&gt;
  else
    &lt;STATEMENT&gt;
fi


</code></pre>
<p><strong>Sample</strong></p>
<pre><code>systemctl is-active psacct &gt; /dev/null 2&gt;&amp;1
if [ $? -ne 0 ] ; then
sudo systemctl start psacct
else
sudo systemctl stop psacct
fi</code></pre>
<p><strong>Regex to match text in command outputs</strong></p>
<blockquote>
<p>Regex can be used with command as vim, grep and less</p>
</blockquote>
<p>There are several options below some samples :</p>
<ul>
<li>Show me lines that starts with <em>cat</em> using <code>^</code></li>
</ul>
<pre><code>grep &#39;^cat&#39; &lt;FILE&gt;</code></pre>
<ul>
<li>Show me lines that ends with <em>cat</em> using <code>$</code></li>
</ul>
<pre><code>grep &#39;cat$&#39; &lt;FILE&gt;</code></pre>
<ul>
<li>Show me lines that start and end with <em>cat</em> using <code>^</code> and <code>$</code></li>
</ul>
<pre><code>grep &#39;^cat$&#39; &lt;FILE&gt;</code></pre>
<ul>
<li>Whildcard for any character <em>c.t</em></li>
</ul>
<pre><code>grep &#39;^c.t$&#39; &lt;FILE&gt;

Output
cat
cit
cot
cpt
cst
</code></pre>
<ul>
<li>Show me lines with one character of list in [xxx]</li>
</ul>
<pre><code>grep &#39;^c[aou]t$&#39; &lt;FILE&gt;

output
cat
cot
cut</code></pre>
<ul>
<li>Show me lines with <em>c</em> + <code>&lt;characters&gt;</code> + <em>t</em></li>
</ul>
<pre><code>grep &#39;c.*t&#39; &lt;FILE&gt;

output
cat
zuchetto
zymochemistry
</code></pre>
<ul>
<li>Show me lines with <em>c</em> + <code>&lt;2  characters&gt;</code> + <em>t</em></li>
</ul>
<p><em>Simple way ‘c..t’</em> but we can use modifiers :</p>
<pre><code>grep &#39;c.\{2\}t&#39; &lt;FILE&gt;

#output
Yacolt
Zacynthus
zoocultural</code></pre>
<ul>
<li>Show me lines that starts with <em>c</em> + <code>&lt;starts with 2 up to 3 characters&gt;</code> + <em>t</em></li>
</ul>
<pre><code>grep &#39;c.\{2,3\}t&#39; &lt;FILE&gt;

#output
zirconate
zoophysicist
zuchetto
zygocactus
zoocyst
</code></pre>
<p><strong>grep Options</strong></p>
<ul>
<li><p><code>-i</code> case insensitivity</p></li>
<li><p><code>-v</code> invert the search</p></li>
<li><p><code>-E</code> search for ln and nx in particular file <code>grep -E 'ln|nx file'</code></p></li>
<li><p>Do not show lines that starts with <em>#</em> <code>^#</code> or <em>blank lines</em> <code>^$</code></p></li>
</ul>
<pre><code>grep -vE &#39;^#|^$&#39; file</code></pre>
<ul>
<li>Do not show lines that starts with <em>#</em> or <em>;</em></li>
</ul>
<pre><code>grep -v &#39;^[#;]&#39; file</code></pre>
</div>
<div id="scheduling-future-tasks" class="section level2">
<h2><span class="header-section-number">3.2</span> Scheduling Future Tasks</h2>
<p><strong>One time Job</strong> : <code>at</code> command</p>
<ul>
<li><code>at</code> <em>TIMESPEC</em> command to schedule a new job
<em>Samples</em>
<ul>
<li><code>at now + 5min</code></li>
<li><code>at teatime tomorrow</code> (<em>teatime is 16:00</em>)</li>
<li><code>at noon + 4 days</code></li>
<li><code>at 5pm august 3 2021</code></li>
</ul>
<em>Cool options</em>
<ul>
<li><code>-g</code> specify a queue <strong>g</strong> , queue goes a to z</li>
</ul></li>
</ul>
<p>*<code>atq</code> to check the jobs schedules on my queue</p>
<ul>
<li>To inspect all info about job</li>
</ul>
<pre><code>at -c &lt;job number&gt;</code></pre>
<ul>
<li>To remove a job</li>
</ul>
<pre><code>atrm &lt;job number&gt; </code></pre>
<ul>
<li>To monitor a job or queue</li>
</ul>
<pre><code>watch atq</code></pre>
<p><strong>Recurring Jobs</strong> <code>cron</code> command</p>
<p><strong>USER</strong></p>
<p>Basic commands :</p>
<ul>
<li><code>crontab -l</code> : list the jobs for the current user</li>
<li>`crontab -r`` : Remove all jobs from current user</li>
<li><code>crontab -e</code> : Edit jobs</li>
<li><code>crontab &lt;filename&gt;</code> : Remove all jobs and replace with the job read from filename, if no file is specified <em>stdin</em> is used</li>
</ul>
<p>Once the job is schedule will have a file on <em>/var/spool/cron/</em></p>
<p>To check the structure of contrab schedule we can check the file <em>/etc/crontab</em></p>
<pre><code>cat /etc/crontab


#output

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# Example of job definition:
# .---------------- minute (0 - 59)
# |  .------------- hour (0 - 23)
# |  |  .---------- day of month (1 - 31)
# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...
# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
# |  |  |  |  |
# *  *  *  *  * user-name command to be executed

</code></pre>
<ul>
<li>Other options</li>
</ul>
<pre><code># every 5min
*/5 * * * * &lt;xxx&gt;   

# every 5min, between 9am and 5pm Sun and Wed in July
*/5 9-16 * Jul sun, wed  

</code></pre>
<ul>
<li><strong>Logs</strong> : Can check the cron jobs logs on <strong>/var/log/cron</strong></li>
</ul>
<p><br></p>
<p><strong>SYSTEM</strong> cron jobs</p>
<p>There are some ways to have a system cron jobs</p>
<ul>
<li><strong>/etc/crontab</strong>
<ul>
<li>Simple add the job on file</li>
</ul></li>
<li><strong>/etc/cron.d/</strong>
<ul>
<li>Add a file with job schedule on this path</li>
</ul></li>
<li><strong>/etc/cron/<path></strong>
<ul>
<li>run the command to check <code>ls /etc/cron\.*</code> we can have folders with cron job files or <strong>scripts</strong></li>
</ul></li>
</ul>
<p>The backup mechanism of cron files is <strong>anacron</strong> and it is configured on <strong>/etc/anacrontab</strong> and the purpose is make sure that all important jobs always run</p>
<ul>
<li>There are different files on <strong>/var/spool/anacron</strong> for each daily, weekly and monthly jobs with timestamps based on schedule if there were a job that should be perform and machine is offline the job will be triggered</li>
</ul>
<p><br></p>
<p><strong>Systemd Timer Unit</strong></p>
<p>This is a new scheduling function introduced on RHEL7, sample :</p>
<p>The <code>sysstat</code> package provides a <em>systemd timer unit</em> called <strong>sysstat-collect.timer</strong> to collect system statistics every 10 minutes. The following output shows the configuration lines of <strong>/usr/lib/systemd/system/sysstat-collect.timer</strong>.</p>
<pre><code>...output omitted...
[Unit]
Description=Run system activity accounting tool every 10 minutes

[Timer]
OnCalendar=*:00/10

[Install]
WantedBy=sysstat.service</code></pre>
<ul>
<li>To check the timers on system</li>
</ul>
<pre><code>systemctl --type timer</code></pre>
<p>If need to modify we can do on <strong>/etc/systemd/system</strong> and after change the timer unit config files need to reload the daemon and activate the timer unit</p>
<pre><code># Reload
systemctl daemon-reload

# Activate
systemctl enable --now &lt;unitname&gt;.timr
</code></pre>
<p><strong>Managing Temporary Files</strong></p>
<p>We can configure <em>timers</em> that manages temporary files.</p>
<ul>
<li>Some applications use <strong>/tmp</strong> to hold temp data</li>
<li>Others use use specific locations such as daemon and user-specific volatile dirs under <strong>/run</strong>, when system reboot those volatile store will be gone.</li>
</ul>
<p>The tool <strong>systemd-tmpfiles</strong> provide structured and configurable method to manage temp dirs and files</p>
<p>When <strong>systemd</strong> starts a system, one of the first service units launched is <strong>systemd-tmpfiles-setup</strong>. This service runs the command</p>
<pre><code>systemd-tmpfiles --create --remove</code></pre>
<p>This command reads configuration files from :</p>
<ul>
<li>/usr/lib/tmpfiles.d/*.conf,</li>
<li>/run/tmpfiles.d/*.conf, and</li>
<li>/etc/tmpfiles.d/*.conf.</li>
</ul>
<p>Any files and directories marked for deletion in those
configuration files is removed, and any files and directories marked for creation (or permission fixes) will be created with the correct permissions if necessary.</p>
<ul>
<li>Cleaning Temporary Files with a Systemd Timer</li>
</ul>
<p>The <strong>systemd</strong> timer unit called <strong>systemd-tmpfiles-clean.timer</strong> triggered <strong>systemd-tmpfiles-clean.service</strong> on regular interval, which executes the command to clean</p>
<pre><code>systemd-tmpfiles --clean</code></pre>
<p>To view the contents of the <strong>systemd-tmpfiles-clean.timer</strong> config files:</p>
<pre><code>systemctl cat systemd-tmpfiles-clean.timer</code></pre>
<p>If need to check the parameter frequence of clean up we need to make sure to reload and enable the timer</p>
<pre><code>systemctl daemon-reload

systemctl enable --now systemd-tmpfiles.clean.timer</code></pre>
<ul>
<li>Cleaning Temporary Files Manually</li>
</ul>
<p>Command :</p>
<pre><code>systemd-tmpfiles --clean</code></pre>
<p><em>this command wll purge all files which have not been accessed, changed, or modified more recently than max age defined on config file</em></p>
<p>The format of config file <strong>systemd-tmpfiles</strong> is detailed in the <strong>tmpfiles.d</strong> manual page</p>
<p>Sample:</p>
<p>create the /run/systemd/seats directory if it does not yet exist, owned by the user root and the group root, with permissions set to rwxr-xr-x. This directory will not be automatically purged.</p>
<pre><code>#Type, Path, Mode, UID, GID, Age, and Argument
d /run/systemd/seats 0755 root root -
</code></pre>
<p>Create the /home/student directory if it does not yet exist. If it does exist, empty it of all contents. When systemd-tmpfiles –clean is run, remove all files which have not been accessed, changed, or modified in more than one day.</p>
<pre><code>#Type, Path, Mode, UID, GID, Age, and Argument
D /home/student 0700 student student 1d</code></pre>
<p>Create the symbolic link /run/fstablink pointing to /etc/fstab. #Never automatically purge this line.</p>
<pre><code>#Type, Path, Mode, UID, GID, Age, and Argument
L /run/fstablink - root root - /etc/fstab</code></pre>
<ul>
<li>Configuration File Precedence</li>
</ul>
<p>The config file can exists in three places:</p>
<ul>
<li>/etc/tmpfiles.d/*.conf
<ul>
<li>provided by the relevant RPM packages, should not edit</li>
</ul></li>
<li>/run/tmpfiles.d/*.conf
<ul>
<li>volatile files, used by daemons</li>
</ul></li>
<li>/usr/lib/tmpfiles.d/*.conf</li>
</ul>
</div>
<div id="tuning-system-performance" class="section level2">
<h2><span class="header-section-number">3.3</span> Tuning System Performance</h2>
<blockquote>
<p><strong>tuned</strong> daemon allow us optmize system performance by selection a tunning profile</p>
</blockquote>
<ul>
<li>To install and enable <strong>tuned</strong></li>
</ul>
<pre><code>yum install tuned
systemctl enable --now tuned</code></pre>
<div id="profiles" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Profiles</h3>
<ul>
<li><p><strong>balanced</strong> : Ideal for systems that require a compromise between power saving and performance.</p></li>
<li><p><strong>desktop</strong> : Derived from the balanced profile. Provides faster response of interactive applications.</p></li>
<li><p><strong>throughput-performance</strong> : Tunes the system for maximum throughput.</p></li>
<li><p><strong>latency-performance</strong> : Ideal for server systems that require low latency at the
expense of power consumption.</p></li>
<li><p><strong>network-latency</strong> : Derived from the latency-performance profile. It enables additional network tuning parameters to provide low network latency.</p></li>
<li><p><strong>network-throughput</strong> : Derived from the throughput-performance profile. Additional network tuning parameters are applied for maximum network throughput.</p></li>
<li><p><strong>powersave</strong> : Tunes the system for maximum power saving.</p></li>
<li><p><strong>oracle</strong> : Optimized for Oracle database loads based on the throughput-performance profile.</p></li>
<li><p><strong>virtual-guest</strong> : Tunes the system for maximum performance if it runs on a virtual machine.</p></li>
<li><p><strong>virtual-host</strong> : Tunes the system for maximum performance if it acts as a host for virtual machines</p></li>
</ul>
</div>
<div id="managing-profiles-from-command-line" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Managing profiles from command line</h3>
<ul>
<li>To active</li>
</ul>
<pre><code>tuned-adm active</code></pre>
<ul>
<li>To List all available profiles</li>
</ul>
<pre><code>tuned-adm list</code></pre>
<ul>
<li>To switch the active profile to a different one</li>
</ul>
<pre><code>tuned-adm profile &lt;profile_name&gt;
tuned-adm active</code></pre>
<ul>
<li>To have a recommendation of profile</li>
</ul>
<pre><code>tuned-adm recommened</code></pre>
<ul>
<li>To deactivate</li>
</ul>
<pre><code>tuned-adm off
tuned-adm active</code></pre>
</div>
<div id="influencing-process-scheduling" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Influencing Process Scheduling</h3>
<blockquote>
<p>Prioritize or de-prioritize specific process with <strong>nice</strong> and <strong>renice</strong></p>
</blockquote>
<ul>
<li>Nice values
<ul>
<li>19 : Nicest (lowest priority)</li>
<li>0 : Neutral</li>
<li>-20: Least nice (highest priority)</li>
</ul></li>
</ul>
<p><img src="img/nice_renice.png" /><!-- --></p>
<ul>
<li>Display Nice Levels from the command line</li>
</ul>
<pre><code>ps axo pid, comm, nice, cls --sort=-nice</code></pre>
<ul>
<li>Start process with different Nice levels</li>
</ul>
<pre><code># default nice is 10
nice sha1sum /dev/zero &amp;

# setting to 15
nice -n 15 sha1sum &amp;</code></pre>
<ul>
<li>Change the Nice level of existing process</li>
</ul>
<pre><code>renice -n &lt;level&gt; &lt;process number&gt;</code></pre>
</div>
</div>
<div id="controling-access-to-files-with-acls" class="section level2">
<h2><span class="header-section-number">3.4</span> Controling Access to Files with ACLs</h2>
<blockquote>
<p>ACLs <em>Access Control List</em> are extention of permissions</p>
</blockquote>
<ul>
<li>To check if file have ACL we going to see a <code>+</code> on long list ouput</li>
</ul>
<pre><code>-rwxrw----+ 1 user operators 130 Mar 19 23:56 reports.txt</code></pre>
<ul>
<li>The group permission on <code>ls -l</code> is masked, will not be the real permission of this file need to check ACL settings</li>
</ul>
<blockquote>
<p>Changing group permissions on a file with an ACL by using <strong>chmod</strong> does not change
the group owner permissions, but does change the ACL mask. Use <strong>setfacl -m
g::perms file</strong> if the intent is to update the file’s group owner permissions.</p>
</blockquote>
<p><br></p>
<ul>
<li>View File or Directory ACLs using <strong>getfacl <File or Dir></strong> command</li>
</ul>
<pre><code>[user@host content]$ getfacl reports.txt
# file: reports.txt
# owner: user
# group: operators
user::rwx
user:consultant3:---
user:1005:rwx          #effective:rw-
group::rwx             #effective:rw-
group:consultant1:r--
group:2210:rwx         #effective:rw-
mask::rw-
other::---</code></pre>
<ul>
<li>The ACL MASK</li>
</ul>
<p>Defines the maximum permissions that you can grant. It does not restrict permissions of the file owner or other user. all files and directories that implement ACL will have an ACL mask.</p>
<p>By default , the mask is recalculated whenever any of the affected ACLs are added, modified or deleted</p>
<ul>
<li>Changing ACL file permissions <strong>setfacl</strong></li>
</ul>
<pre><code>$ setfacl -m u:name:rX file</code></pre>
<ul>
<li><code>-m</code> : modify ,
<ul>
<li><code>x</code> delete</li>
</ul></li>
<li><code>u</code> : user,
<ul>
<li><code>g</code> for group,<br />
</li>
<li><code>o</code> for others</li>
</ul></li>
<li><code>name</code>: name of user</li>
<li><code>rX</code> : permission
<ul>
<li><code>X</code> uppercase can be used to indicate that execute permission should only be set on dir and not regular files, unless the file already has the relevant execute permission.</li>
</ul></li>
<li>ACL recursive modifications</li>
</ul>
<pre><code>$ setfacl -R -m u:name:rX directory</code></pre>
<ul>
<li>Deleting ACL</li>
</ul>
<pre><code>$ setfacl -x u:name,g:name file</code></pre>
<ul>
<li>Delete all ACL entries</li>
</ul>
<pre><code>$ setfacl -b file</code></pre>
</div>
<div id="managing-selinux-security" class="section level2">
<h2><span class="header-section-number">3.5</span> Managing SELinux Security</h2>
<blockquote>
<p>Security Enhanced Linux (<em>SELinux</em>) is an additional layer of system security. The primary goal of SELinux is to <strong>protect user data</strong> from system services that have been compromised</p>
</blockquote>
<p><strong>Targeted policy</strong> <em>default</em></p>
<p>SELinux consists of sets of policies, defined by the application developers, that declare exactly
what actions and accesses are proper and allowed for each binary executable, configuration
file, and data file used by an application.</p>
<ul>
<li><em>Modes</em>
<ul>
<li><strong>Enforcing</strong> : SELinux is enforcing access control rules. Computers generally run in this mode.</li>
<li><strong>Permissive</strong> : SELinux is active but instead of enforcing access control rules, it records warnings of rules that have been violated. This mode is used primarily for <strong>testing</strong> and <strong>troubleshooting</strong></li>
<li><strong>Disabled</strong> : SELinux is turned off entirely: no SELinux violations are denied, nor even recorded. <strong>Discouraged!</strong></li>
</ul></li>
<li>To show SELinux information <code>ls -lZ</code></li>
</ul>
<p><img src="img/SELinux.png" /><!-- --></p>
<ul>
<li>Checking the current state</li>
</ul>
<pre><code>[user@host ~]# getenforce
Enforcing</code></pre>
<ul>
<li>Check the persistently state</li>
</ul>
<pre><code>cat /etc/selinux/config</code></pre>
<ul>
<li>Set enforce mode</li>
</ul>
<pre><code>[user@host ~]# setenforce
usage: setenforce [ Enforcing | Permissive | 1 | 0 ]
[user@host ~]# setenforce 0
[user@host ~]# getenforce
Permissive</code></pre>
<ul>
<li>Check status</li>
</ul>
<pre><code>sestatus</code></pre>
<div id="controlling-selinux-file-contexts" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Controlling SELinux File Contexts</h3>
<ul>
<li>When <strong>copy</strong> a file or <strong>create</strong> a new file the file <strong>inherits</strong> the SELinux <strong>context</strong> of the directory</li>
<li>If I <strong>move</strong> a file it <strong>retain</strong> the SELinux <strong>context</strong></li>
</ul>
<p><strong>Change context of a file</strong></p>
<ul>
<li>Commands
<ul>
<li><strong>semanage</strong> : create the role, a create page is <code>man semanage-fcontext</code> , sample of rule :</li>
</ul>
<pre><code># create the rule
semanage fcontext -a -t httpd_sys_content_t &quot;/web(/.*)?&quot;

# apply a new rule
restorecon -R -v /web</code></pre>
<ul>
<li><strong>fcontext</strong> : used to list and see changes</li>
</ul>
<pre><code># l : list
# C : change
semage fcontext -lC</code></pre>
<ul>
<li><strong>restorecon</strong> : use when the file already in the correct location, for example, if someone moved the file from A to B and B is the correct location, using the command <code>restorecon &lt;file&gt;</code> will restore the context</li>
<li><strong>chcon</strong> : It is not persistent , does not survive restorecon or relable, <strong>avoid</strong></li>
</ul></li>
</ul>
</div>
<div id="adjusting-selinux-policy-with-booleans" class="section level3">
<h3><span class="header-section-number">3.5.2</span> Adjusting SELinux Policy with Booleans</h3>
<blockquote>
<p>SELinux booleans are switches that change the behavior of the SELinux policy. SELinux booleans
are rules that can be enabled or disabled.</p>
</blockquote>
<ul>
<li>Check booleans</li>
</ul>
<pre><code>[user@host ~]$ getsebool -a
abrt_anon_write --&gt; off
abrt_handle_event --&gt; off
abrt_upload_watch_anon_write --&gt; on
antivirus_can_scan_system --&gt; off
antivirus_use_jit --&gt; off
...output omitted...


[user@host ~]$ getsebool httpd_enable_homedirs
httpd_enable_homedirs --&gt; off


# list booleans 
[user@host ~]$ sudo semanage boolean -l | grep httpd_enable_homedirs
httpd_enable_homedirs  (on,on) Allow httpd to enable homedirs</code></pre>
<ul>
<li>write pending values to policy, P(<em>persistence</em>)</li>
</ul>
<pre><code>setsebool -P httpd_enable_homedirs on</code></pre>
<ul>
<li>list booleans with current state and diff from default state</li>
</ul>
<pre><code>[user@host ~]$ sudo semanage boolean -l -C
SELinux boolean       State Default Description
cron_can_relabel        (off,on)  Allow cron to can relab</code></pre>
</div>
<div id="investigating-and-resolving-selinux-issues" class="section level3">
<h3><span class="header-section-number">3.5.3</span> Investigating and REsolving SELinux issues</h3>
<ul>
<li><strong>sealert</strong> display info during SELinux troubleshooting</li>
</ul>
<p><em>Guide to troubleshooting SELinux issues:</em></p>
<ol style="list-style-type: decimal">
<li><p>Before thinking of making any adjustments, consider that SELinux may be doing its job
correctly by prohibiting the attempted access.</p></li>
<li><p>The most common SELinux issue is an incorrect file context, <em>“when we move files”</em>.</p></li>
<li><p>Another remedy for overly restrictive access could be the adjustment of a Boolean.</p></li>
<li><p>It is possible that the SELinux policy has a bug that prevents a legitimate access.</p></li>
</ol>
<p><strong>Monitor SELinux Violations</strong></p>
<p>If we have the package <code>setroubleshoot-serve</code> installed</p>
<ul>
<li><strong>/var/log/audit/audit.log</strong> : received log messages related SELinux violations</li>
<li><strong>/var/log/messages</strong> : short summary of SELinux violations messages</li>
</ul>
</div>
</div>
<div id="managing-basic-storage" class="section level2">
<h2><span class="header-section-number">3.6</span> Managing Basic Storage</h2>
<div id="adding-partition-file-systems-and-persistent-mounts" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Adding Partition, File Systems and Persistent Mounts</h3>
<ul>
<li><strong>MBR Partitioning Schema</strong>
<ul>
<li>The <em>Master Boot Record (MBR)</em> partitioning schema dictated how disks are partitioned on system running BIOS firmware
<ul>
<li>Can have manimum of four primary partition</li>
<li>Maximum disk and partition size of 2TiB</li>
<li>Using extended and logical partitions we can create a maximum of 15 partitions</li>
</ul></li>
</ul></li>
</ul>
<p><img src="img/mbr.png" /><!-- --></p>
<ul>
<li><strong>GPT Partitioning Schema</strong>
<ul>
<li>The <em>Unified Extensible Firmware Interface (UEFI)</em> firmware is a standard laying out
<ul>
<li>Does not have limit of 2TB</li>
<li>Maximum of 128 partitions</li>
<li>Maximum of 8ZiB zebibytes</li>
<li>have a backup on the end of the disk</li>
</ul></li>
</ul></li>
</ul>
<p><img src="img/gpt.png" /><!-- --></p>
<ul>
<li><strong>Managing Partitions with Parted</strong></li>
</ul>
<p>Partition editors are programs which allow admin to make changes to a disk’s</p>
<p><strong>parted</strong> command</p>
<ul>
<li>Display info of <code>/dev/vda</code> with subcommand <strong>print</strong>
<ul>
<li>if do not provide subcommand will open an interactive session</li>
<li>we can change the display to KB, MB, GB, TB or S for sector using <code>unit s</code> argument</li>
<li><strong>parted</strong> makes the change immediately</li>
</ul></li>
</ul>
<pre><code>[root@host ~]# parted /dev/vda print
Model: Virtio Block Device (virtblk)
Disk /dev/vda: 53.7GB
Sector size (logical/physical): 512B/512B
Partition Table: msdos
Disk Flags:

Number  Start       End       Size        Type     File system    Flags  
1       1049kB      10.7GB    10.7GB    primary     xfs           boot
2       10.7GB      53.7GB    42.9GB    primary     xfs
</code></pre>
<p><strong>Writing the partition table on a NEW DISK</strong></p>
<p><em>MBR</em></p>
<pre><code>[root@host ~]# parted /dev/vdb mklabel msdos</code></pre>
<p><em>GPT</em></p>
<pre><code>[root@host ~]# parted /dev/vdb mklabel gpt</code></pre>
<blockquote>
<p>The <strong>mklabel</strong> subcommand wipes the existing partition table. Only use mklabel
when the intent is to reuse the disk without regard to the existing data. If a new
label changes the partition boundaries, <strong>all data in existing file systems will become
inaccessible</strong>.</p>
</blockquote>
<p><br></p>
<p><strong>Creating MBR Partitions</strong></p>
<ol style="list-style-type: decimal">
<li>Specify the disk device to create the partition on using <strong>parted </dev/xxx></strong></li>
</ol>
<pre><code># parted /dev/vdb</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Use the <strong>mpart</strong> subcommand to create new primary or extented partition</li>
</ol>
<pre><code>(parted) mkpart
Partition type?
primary/extended? primary</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Indicate the file-system type, to get the list of all types use <code>parted /dev/vdb help mkpart</code></li>
</ol>
<pre><code>File system type? [ext2]? xfs</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Specify the sector on disk</li>
</ol>
<pre><code>Start? 2048s</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Specify where the new partition will end</li>
</ol>
<pre><code>End? 1000MB</code></pre>
<ol start="6" style="list-style-type: decimal">
<li><p>Exit using <code>quit</code></p></li>
<li><p>Run the <strong>udevadm settle</strong> for the system detect the new partition</p></li>
</ol>
<p><em>Option</em>: if we have all the details we can use only one command to perform all actions</p>
<pre><code>[root@host ~]# parted /dev/vdb mkpart primary xfs 2048s 1000MB</code></pre>
<p><br></p>
<p><strong>Creating GPT Partitions</strong></p>
<ol style="list-style-type: decimal">
<li>Specificy the disk device to create the partition on</li>
</ol>
<pre><code># parted /dev/vdb</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Use the <strong>mkpart</strong> to start creating the new partition, with GPT each partition is given a <em>name</em></li>
</ol>
<pre><code>(parted) mkpart
Partition name?  []? usersdata</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Indicate the type</li>
</ol>
<pre><code>File system type? [ext2]? xfs</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Specify the sector on disk that the new partition starts on</li>
</ol>
<pre><code>Start? 2048s</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Specify the end</li>
</ol>
<pre><code>End? 1000MB</code></pre>
<ol start="6" style="list-style-type: decimal">
<li><p>Exit using <code>quit</code></p></li>
<li><p>Run the <strong>udevadm settle</strong> for the system detect the new partition</p></li>
</ol>
<p><em>Option</em>: if we have all the details we can use only one command to perform all actions</p>
<pre><code>[root@host ~]# parted /dev/vdb mkpart usersdata xfs 2048s 1000MB</code></pre>
<p><br></p>
<p><strong>Deleting Partitions</strong></p>
<ol style="list-style-type: decimal">
<li>Specify the disk</li>
</ol>
<pre><code>[root@host ~]# parted /dev/vdb</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Identify the partition number of the partition to delete</li>
</ol>
<pre><code>(parted) print
</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Delete using <code>rm</code> subcomand</li>
</ol>
<p><em>The rm subcommand immediately deletes the partition from the partition table on the disk.</em></p>
<pre><code>(parted) rm &lt;number&gt;</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Exit using <code>quit</code></li>
</ol>
<p><br></p>
<p><strong>Creating File Systems</strong></p>
<ul>
<li>Check if <code>fdisk</code> for MBR and <code>gdisk</code> for GPT are installed</li>
</ul>
<pre><code>$ which fdisk

# check the package
$ rpm -qf /sbin/fdisk


# install gdisk
yum -y install gdisk
</code></pre>
<ul>
<li>Sample of using <strong>gdisk</strong></li>
</ul>
<pre><code>$ gdisk /dev/vdd
</code></pre>
<ul>
<li><p><code>?</code> : help</p></li>
<li><p><code>p</code> : print</p></li>
<li><p><code>n</code> : new partition</p></li>
<li><p>Specify the partition number, First sector and Last sector or size</p></li>
<li><p>Specify the GUID Label</p>
<ul>
<li><code>L</code> : show all label codes</li>
</ul></li>
<li><p>print to check</p></li>
<li><p><code>c</code> : change the partition name</p></li>
<li><p><code>w</code> : write</p></li>
<li><p>Confirm</p></li>
<li><p>Check with <code>lsblk</code></p></li>
<li><p>Create the file system using <strong>mkfs.xfs</strong></p></li>
</ul>
<pre><code>$ mkfs.xfs /dev/vdb1</code></pre>
<ul>
<li>To check the file system creation using <strong>blkid</strong> will show the <em>UUID</em></li>
</ul>
<pre><code>$ blkid</code></pre>
<ul>
<li>To mount
<ul>
<li>temporarily mount</li>
</ul>
<pre><code>mount /dev/vdb1 /mnt</code></pre>
<ul>
<li>Persistently mount
<ol style="list-style-type: decimal">
<li>update <strong>/etc/fstab</strong></li>
<li>Reload the daemon <code>systemctl daemon-reload</code></li>
<li>check fs <code>lsblk --fs</code></li>
<li>create the dir <code>mkdir &lt;dir&gt;</code></li>
<li>mount the fs <code>mount &lt;fs&gt;</code></li>
</ol></li>
</ul></li>
</ul>
</div>
<div id="managing-swap-space" class="section level3">
<h3><span class="header-section-number">3.6.2</span> Managing Swap Space</h3>
<p>A <em>swap space</em> is an area of a disk under the control of the Linux kernel memory management
subsystem. The kernel uses swap space to supplement the system RAM by holding inactive pages
of memory. The combined system RAM plus swap space is called <em>virtual memory</em>.</p>
<p><img src="img/swap.png" /><!-- --></p>
<p><br></p>
<p><strong>Creating a Swap Space</strong></p>
<ul>
<li>Create a partition with a file system type of <strong>linux-swap</strong></li>
<li>Run <code>udevadm settle</code></li>
<li>Formatting the device</li>
</ul>
<pre><code>mkswap /dev/vdb2</code></pre>
<ul>
<li>Add on <strong>/etc/fstab</strong></li>
</ul>
<pre><code>#sample
UUID=39e2667a-9458-42fe-9665-c5c854605881  swap  swap  defaults  0 0</code></pre>
<ul>
<li>Activate the swap</li>
</ul>
<pre><code>swappon /dev/vdb2

# activate all the swap spaces
swapon -a

# check swap
swapon -s
</code></pre>
<ul>
<li>Setting Swap Space Priority
<ul>
<li>default is <strong>-2</strong></li>
<li>Update <strong>/etc/fstab</strong> and specify <strong>pri=priority number</strong> instead of defaults</li>
</ul></li>
</ul>
</div>
</div>
<div id="managing-logical-volumes" class="section level2">
<h2><span class="header-section-number">3.7</span> Managing Logical Volumes</h2>
<div id="creating-logical-volumes" class="section level3">
<h3><span class="header-section-number">3.7.1</span> Creating Logical Volumes</h3>
<p>Using Logical volumes is easier to manage disk space, we can allocate to logical volume free space from volume group and file system can be resized</p>
<p>LVM Definitions</p>
<p><em>Physical devices</em>
* Storage devices used to save data stored in a lofical volume
* Could be a disk partition, whole disk, RAID arrays or SAN Disk
* Device must be initialized as an LVM</p>
<p><em>Physical volumes (PVs)</em>
* “Physical” storage used with LVM
* We must initilize a device as a physical volume before use as LVM
* PV can only be allocated to a single VG</p>
<p><em>Volume group (VGs)</em>
* <strong>Storage pool</strong> made up of one or more physical volumes
* A VG can consiste of unused space an any number of logical Volumes</p>
<p><em>Logical volumes (LVs)</em>
* Create from free physical extents in a volume group and provide the storage used by applications, users and OS
* Collection of logical extents (LEs), which map to physical extents</p>
<p><img src="img/logical_volumes.png" /><!-- --></p>
<p><br></p>
<p><strong>Steps to create logical volumes</strong></p>
<ol style="list-style-type: decimal">
<li><p>Use <strong>lsblk</strong>, <strong>blkid</strong> or <strong>cat /proc/partition</strong> to identify the devices</p></li>
<li><p>Prepare the physical device</p></li>
</ol>
<ul>
<li>Use <strong>parted</strong>, <strong>gdisk</strong> or <strong>fdisk</strong> tp create a new partition for use with LVM</li>
<li>Type of <strong>Linux LVM</strong> on LVM partitions</li>
<li>Use <strong>0x8e</strong> for MBR</li>
<li>Use <strong>partprobe</strong> to register the new partition with the kernel</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Create a physical volume</li>
</ol>
<ul>
<li><strong>pvcreate</strong> to label the partition as a physical volume, it divides the physical volume into physical extents (PEs) of fixed size of 4MB block.</li>
</ul>
<pre><code>pvcreate /dev/vdb2 /dev/vdb1</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Create the volume group</li>
</ol>
<ul>
<li><strong>vgcreate</strong> used to collect one or more physical volumes into a volume group. It is equivalent of hard disk</li>
</ul>
<pre><code>vgcreate vg01 /dev/vdb2 /dev/vdb1</code></pre>
<p><em>This creates a VG called vg01 that is the combined size, in PE units, of the two PVs /dev/vdb2 and /dev/vdb1</em></p>
<ol start="5" style="list-style-type: decimal">
<li>Create a logical volume</li>
</ol>
<ul>
<li>Use <strong>lvcreate</strong> to create a new logical volume from available physical extents in a volume group
<ul>
<li><code>-n</code> : to set the LV name</li>
<li><code>-L</code> : to set the LV size in bytes</li>
<li><code>-l</code> : to set the LV size in extents</li>
</ul></li>
</ul>
<pre><code>lvcreate -n lv01 -L 700M vg01</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Add the file system</li>
</ol>
<ul>
<li>Use <strong>mkfs</strong> to create an <strong>XFS</strong> file system on the new logical volume</li>
</ul>
<pre><code># create FS
mkfs -t xfs /dev/vg01/lv01

# create dir mount point
mkdir /mnt/data

# Update /etc/fstab
/dev/vg01/lv01 /mnt/data xfs defaults 1 2

# mount
mount /mnt/data
</code></pre>
<p><br></p>
<p><strong>Remove a Logical Volume</strong></p>
<ol style="list-style-type: decimal">
<li>Umount the fs and remove the info from /etc/fstab</li>
</ol>
<pre><code>umount /mnt/data</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Remove the logical volume</li>
</ol>
<pre><code>lvremove /dev/vg01/lv01
</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Remove the volume group</li>
</ol>
<pre><code>vgremove vg01</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Remove the physical volumes</li>
</ol>
<pre><code>pvremove /dev/vdb2 /dev/vdb1</code></pre>
<p><br></p>
<p><strong>Review LVM Status Info</strong></p>
<ul>
<li>Physical Volumes</li>
</ul>
<pre><code>pvdisplay /dev/vdb1</code></pre>
<ul>
<li>Volumes Groups</li>
</ul>
<pre><code>vgdisplay vg01</code></pre>
<ul>
<li>Logical Volumes</li>
</ul>
<pre><code>lvdisplay /dev/vg01/lv01</code></pre>
</div>
<div id="extending-and-reducing-logical-volumes" class="section level3">
<h3><span class="header-section-number">3.7.2</span> Extending and Reducing Logical Volumes</h3>
<p><strong>Extending Volume groups</strong> : We can add more disk space to a volume group by adding additional physical volumes. Then assign the new physical extents to logical volumes.</p>
<p><strong>Reducing the volume group</strong> : We also can remove unused physical volume from a volume group
* First use <code>pvmove</code> to move data from extents on one physical volume to extents on another physical extents</p>
<p><br></p>
<p><strong>Extending a Volume group</strong></p>
<ol style="list-style-type: decimal">
<li>Prepare the physical device and create the physical volume</li>
</ol>
<pre><code>[root@host ~]# parted -s /dev/vdb mkpart primary 1027MiB 1539MiB
[root@host ~]# parted -s /dev/vdb set 3 lvm on
[root@host ~]# pvcreate /dev/vdb3</code></pre>
<p><em>A PV only needs to be created if there are no PVs free to extend the VG.</em></p>
<ol start="2" style="list-style-type: decimal">
<li>Use <strong>vgextend</strong> to add the new physical volume to the volume group</li>
</ol>
<pre><code>[root@host ~]# vgextend vg01 /dev/vdb3</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><strong>vgdisplay</strong> to confirm the additional physical extents are available</li>
</ol>
<pre><code>[root@host ~]# vgdisplay vg01</code></pre>
<p><em>Inspect the <strong>Free PE / Size</strong></em></p>
<p><br></p>
<p><strong>Reducing a Volume Group</strong></p>
<ol style="list-style-type: decimal">
<li>Use <strong>pvmode PV_DEVICE_NAME</strong> to relocate any physical extents</li>
</ol>
<pre><code>[root@host ~]# pvmove /dev/vdb3</code></pre>
<ul>
<li><em>This command moves the PEs from /dev/vdb3 to other PVs with free PEs in the same VG.</em></li>
<li><em>Always backup the data before <strong>pvmove</strong></em></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Reduce the volume using <strong>vgreduce</strong></li>
</ol>
<pre><code>[root@host ~]# vgreduce vg01 /dev/vdb3</code></pre>
<p><em>This removes the /dev/vdb3 PV from the vg01 VG and it can now be added to another VG. Alternatively, <strong>pvremove</strong> can be used to permanently stop using the device as a PV</em></p>
<p><br></p>
<p><strong>Extending a Logical Volume and XFS File System</strong></p>
<ol style="list-style-type: decimal">
<li>Verify that the volume group has space available.</li>
</ol>
<pre><code>[root@host ~]# vgdisplay vg01</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Extend the logical volume with <strong>lvextendLV_DEVICE_NAME</strong></li>
</ol>
<pre><code>[root@host ~]# lvextend -L +300M /dev/vg01/lv01</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Extend the file system using <strong>xfs_growfs mountpoint</strong></li>
</ol>
<pre><code>[root@host ~]# xfs_growfs /mnt/data</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Verify the new size of file system</li>
</ol>
<pre><code>[root@host ~]# df -h /mountpoint</code></pre>
<p><br></p>
<p><strong>Extending a Logical Volume and ext4 File System</strong></p>
<ol style="list-style-type: decimal">
<li>Verify that the volume group has space available.</li>
</ol>
<pre><code>[root@host ~]# vgdisplay vg01</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Extend the logical volume with <strong>lvextend LV_DEVICE_NAME</strong></li>
</ol>
<pre><code>[root@host ~]# lvextend -L +300M /dev/vg01/lv01</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Extend the file system</li>
</ol>
<pre><code>[root@host ~]# resize2fs /dev/vg01/lv01</code></pre>
<p><br></p>
<p><strong>Extend a logical volume and swap space</strong></p>
<ol style="list-style-type: decimal">
<li>Verify that the volume group has space available.</li>
</ol>
<pre><code>[root@host ~]# vgdisplay vg01</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Deactivate the swap space.</li>
</ol>
<pre><code>swapoff -v /dev/vgname/lvname</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Extend the logical volume with <strong>lvextend LV_DEVICE_NAME</strong></li>
</ol>
<pre><code>[root@host ~]# lvextend -L +300M /dev/vg01/lv01</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Format the logical volume as swap space.</li>
</ol>
<pre><code>mkswap /dev/vgname/lvname</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Activate the swap space</li>
</ol>
<pre><code>swapon -va /dev/vgname/lvname</code></pre>
</div>
</div>
<div id="implementing-advanced-storage-features" class="section level2">
<h2><span class="header-section-number">3.8</span> Implementing Advanced Storage Features</h2>
<div id="managing-storage-with-stratis" class="section level3">
<h3><span class="header-section-number">3.8.1</span> Managing Storage with Stratis</h3>
<blockquote>
<p><strong>STRATIS</strong> is a new storage-management solution for Linux, runs as a service that manages pools of physical storage devices and transparently creates and manages volumes for the newly created file system.</p>
</blockquote>
<ul>
<li><p>Instead of immediately allocating physical storage space to the file system when it is created, Stratis dynamically allocates that space from the pool as the file system stores more data</p></li>
<li><p>We can create multiple pools from different storage devices.</p></li>
<li><p>File systems created by Stratis should only be reconfigured with Stratis tools and
commands.</p></li>
</ul>
<p><img src="img/stratis.png" /><!-- --></p>
<p>To use we need to install the <strong>stratis-cli</strong> and <strong>stratisd</strong></p>
<p><strong>To install Stratis</strong></p>
<pre><code>[root@host ~]# yum install stratis-cli stratisd
[root@host ~]# systemctl enable --now stratisd</code></pre>
<ul>
<li><strong>Create pools</strong> of one or more block devices using the stratis pool create command.</li>
</ul>
<pre><code>[root@host ~]# stratis pool create pool1 /dev/vdb</code></pre>
<ul>
<li>To view the list of available pools</li>
</ul>
<pre><code>[root@host ~]# stratis pool list</code></pre>
<ul>
<li>To add additional block devices to a pool</li>
</ul>
<pre><code>[root@host ~]# stratis pool add-data pool1 /dev/vdc</code></pre>
<ul>
<li>To view the block devices of a pool</li>
</ul>
<pre><code>[root@host ~]# stratis blockdev list pool1</code></pre>
<ul>
<li>To create a file system from a pool</li>
</ul>
<pre><code>[root@host ~]# stratis filesystem create pool1 fs1</code></pre>
<ul>
<li>To view the list of available file systems</li>
</ul>
<pre><code>[root@host ~]# stratis filesystem list</code></pre>
<ul>
<li>To create a snapshot</li>
</ul>
<pre><code>[root@host ~]# stratis filesystem snapshot pool1 fs1 snapshot1</code></pre>
<ul>
<li>To mount the Stratis file system persistently</li>
</ul>
<pre><code># get UID
[root@host ~]# lsblk --output=UUID /stratis/pool1/fs1

# add on /etc/fstab
UUID=31b9363b-add8-4b46-a4bf-c199cd478c55 /dir1 xfs defaults,x-systemd.requires=stratisd.service 0 0</code></pre>
<p><em>The <strong>x-systemd.requires=stratisd.service</strong> mount option delays mounting the file system
until after <strong>systemd</strong> starts the <strong>stratisd.service</strong> during the boot process</em></p>
</div>
<div id="compressing-and-deduplicating-storage-with-vdo" class="section level3">
<h3><span class="header-section-number">3.8.2</span> Compressing and Deduplicating Storage with VDO</h3>
<p>Virtual Data Optimizer (VDO) is a Linux device mapper driver that reduces disk space usage on block devices, and minimizes the replication of data.</p>
<ul>
<li><em>Kernel modules</em>
<ul>
<li><strong>kvdo</strong> : Control data compression</li>
<li><strong>uds</strong> : Deduplication</li>
</ul></li>
</ul>
<p><br></p>
<p>VDO <strong>phases to reduce</strong> the footprint on storage</p>
<ol style="list-style-type: decimal">
<li><em>Zero-block Elimination</em> filter out data that contain only zeros</li>
<li><em>Deduplication</em> eliminate redudant blocks</li>
<li><em>Compression</em> the <strong>kvdo</strong> compress the data block using LZ4</li>
</ol>
<p><br></p>
<ul>
<li>Install the <em>vdo</em> and <em>kmod-kvdo</em></li>
</ul>
<pre><code>[root@host ~]# yum install vdo kmod-kvdo</code></pre>
<ul>
<li>Check status of vdo service</li>
</ul>
<pre><code>systemctl status vdo</code></pre>
<ul>
<li>Creating VDO volume</li>
</ul>
<pre><code>[root@host ~]# vdo create --name=vdo1 --device=/dev/vdd --vdoLogicalSize=50G</code></pre>
<ul>
<li>Analyzing a VDO Volume</li>
</ul>
<pre><code>[root@host ~]# vdo status --name=vdo1</code></pre>
<ul>
<li>Display the list of VDO</li>
</ul>
<pre><code>vdo list</code></pre>
<ul>
<li>Stop / Start vdo</li>
</ul>
<pre><code>vdo stop
vdo start</code></pre>
<blockquote>
<p>When the logical size of a VDO volume is more than the actual physical size, you should proactively monitor the volume statistics to view the actual usage using the <strong>vdostats –verbose</strong> command.</p>
</blockquote>
<pre><code>vdostats --human-readable</code></pre>
<p><br></p>
<p><strong>TIPS</strong></p>
<ul>
<li>To test we might need to create a 2G file, below a sample</li>
</ul>
<pre><code>dd if=/dev/urandom of=&lt;path&gt;/&lt;file_name&gt; bs=1M count=2048</code></pre>
<ul>
<li>If made a mistake on fstab and need to access the server with root and root home dir is mounted as read only we can remount using below command</li>
</ul>
<pre><code>mount -o remount, rw /</code></pre>
</div>
</div>
<div id="accessing-network-attached-storage" class="section level2">
<h2><span class="header-section-number">3.9</span> Accessing Network-Attached Storage</h2>
<div id="mounting-network-attached-storage-with-nfs" class="section level3">
<h3><span class="header-section-number">3.9.1</span> Mounting Network-Attached Storage with NFS</h3>
<p>NFS servers export shares (directories). NFS clients mount an exported share to a local mount
point (directory), which must exist. NFS shares can be mounted a number of ways:</p>
<ul>
<li>Manually, using the <strong>mount</strong> command</li>
<li>Automatically at boot time using <strong>/etc/fstab</strong></li>
<li>On demand, using <strong>autofs</strong> or <strong>systemd.automount</strong>.</li>
</ul>
<p><br></p>
<p><strong>Mounting NFS Shares</strong></p>
<ol style="list-style-type: decimal">
<li><strong>Identify</strong> NFS Shares</li>
</ol>
<pre><code>[user@host ~]$ sudo mkdir mountpoint
[user@host ~]$ sudo mount serverb:/ mountpoint
[user@host ~]$ sudo ls mountpoint</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><strong>Mount point</strong> use mkdir to create a mount point</li>
</ol>
<pre><code>[user@host ~]$ mkdir -p mountpoint</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><strong>Mount</strong></li>
</ol>
<p><em>Temporarily</em></p>
<pre><code>[user@host ~]$ sudo mount -t nfs -o rw,sync serverb:/share mountpoint</code></pre>
<ul>
<li><code>-t nfs</code> : file system type for NFS Share</li>
<li><code>-o sync</code>: immediately sync write operations with server</li>
</ul>
<p><em>Persistently</em></p>
<ul>
<li>Configure <strong>/etc/fstab</strong></li>
</ul>
<pre><code>[user@host ~]$ sudo vim /etc/fstab
serverb:/share /mountpoint nfs rw,soft 0 0</code></pre>
<ul>
<li>Mount the NFS Share</li>
</ul>
<pre><code>[user@host ~]$ sudo mount /mountpoint</code></pre>
<p><strong>Unmounting NFS Shares</strong></p>
<pre><code>[user@host ~]$ sudo umount mountpoint</code></pre>
</div>
<div id="automounting-network-attached-storage" class="section level3">
<h3><span class="header-section-number">3.9.2</span> Automounting Network-Attached Storage</h3>
<blockquote>
<p>The automounter is a service (<strong>autofs</strong>) that automatically mounts NFS shares <em>“on-demand”</em>, and will automatically unmount NFS shares when they are no longer being used.</p>
</blockquote>
<ul>
<li>Create an automount</li>
</ul>
<ol style="list-style-type: decimal">
<li>Install <em>autofs</em></li>
</ol>
<pre><code>[user@host ~]$ sudo yum install autofs</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Add a <em>master map</em> file to <strong>/etc/auto.master.d</strong></li>
</ol>
<pre><code>[user@host ~]$ sudo vim /etc/auto.master.d/demo.autofs

## add
/shares /etc/auto.demo</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Create the mapping files</li>
</ol>
<pre><code>[user@host ~]$ sudo vim /etc/auto.demo

# add
work -rw,sync serverb:/shares/work</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Start and enable the automounter service</li>
</ol>
<pre><code>[user@host ~]$ sudo systemctl enable --now autofs</code></pre>
<p><br></p>
<ul>
<li>Direct Maps</li>
</ul>
<p><em>Direct maps are used to map an NFS share to an existing absolute path mount point.</em></p>
<ul>
<li>To use the master map file should be like :</li>
</ul>
<pre><code>/- /etc/auto.direct
</code></pre>
<ul>
<li>The content for the <strong>/etc/auto.direct</strong> will be :</li>
</ul>
<pre><code>/mnt/docs -rw,sync serverb:/shares/docs</code></pre>
<p><br></p>
<ul>
<li>Indirect Wildcard Maps</li>
</ul>
<pre><code>* -rw,sync serverb:/shares/&amp;</code></pre>
</div>
</div>
<div id="controlling-the-boot-process" class="section level2">
<h2><span class="header-section-number">3.10</span> Controlling The Boot Process</h2>
<div id="selecting-the-boot-target" class="section level3">
<h3><span class="header-section-number">3.10.1</span> Selecting the boot target</h3>
<p><strong>Describing the Red Hat Enterprise Linux 8 Boot Process</strong></p>
<ul>
<li>The machine is powered on the UEFI or BIOS runs <em>Power On Self Test (POST)</em> and start, <strong>F2</strong> or some system <strong>Esc</strong> usually to access configuartion and <strong>E</strong> to edit</li>
<li>Firmware search for a bootable device</li>
<li>The firmware read a boot loader and passes control of system to the boot loader, in RHEL 8 <em>GRand Unified Bootloader version 2 (GRUB2)</em> configured using <strong>grub2-install</strong></li>
<li>GRUB2 load the config from <strong>/boot/grub2/grub.cfg</strong> and display the menu, where we can select the kernel. Configured using the <strong>/etc/grub.d/</strong> directory, the <strong>/etc/default/grub</strong> file, and the <strong>grub2-mkconfig</strong> command to generate the <strong>/boot/grub2/grub.cfg</strong> file</li>
<li>After timeout or select the kernel boot loader load the kernel and <strong>initramfs</strong> set of initialization configured on <strong>/etc/dracut.conf.d/</strong> using <strong>dracut</strong> and <strong>lsinitrd</strong> command</li>
<li>Kernel initializes all hardware and execute the <strong>/sbin/init</strong> from <strong>initramfs</strong> as PID 1.</li>
<li>The <strong>systemd</strong> execute all instances for the <strong>initrd.target</strong> such as mount root file system.</li>
</ul>
<p><strong>Rebooting and Shutting Down</strong></p>
<ul>
<li><p><code>systemctl poweroff</code> : Stops all running services, unmounts all file system and power down the system</p></li>
<li><p><code>systemctl reboot</code> : Stops all running services, unmount al file system and then reboot the system</p></li>
<li><p><code>systemctl halt</code> : Stop the system, but do not power off the system</p></li>
</ul>
<p><strong>Selecting a System Target</strong></p>
<ul>
<li><strong>systemd</strong> targets is a set of systemd units that system should start to reach the desired state
<ul>
<li><strong>graphical.target</strong> : supports multiple users, graphical-and text logins</li>
<li><strong>multi-user.target</strong>: system supports multiple users, text logins only</li>
<li><strong>rescue.target</strong> : <strong>sulogin</strong> prompt, basic system initialization completed</li>
<li><strong>emergency.target</strong>: <strong>sulogin</strong> prompt, <strong>initramfs</strong> pivot complete and system root mounted on <strong>/</strong> read only</li>
</ul></li>
<li>List dependencies for graphical.target</li>
</ul>
<pre><code>systemctl list-dependencies graphical.target | grep target

# output

graphical.target
● └─multi-user.target
●   ├─basic.target
●   │ ├─paths.target
●   │ ├─slices.target
●   │ ├─sockets.target
●   │ ├─sysinit.target
●   │ │ ├─cryptsetup.target
●   │ │ ├─local-fs.target
●   │ │ └─swap.target
●   │ └─timers.target
●   ├─getty.target
●   └─remote-fs.target</code></pre>
<ul>
<li>To list the available targets :</li>
</ul>
<pre><code>systemctl list-units --type=target --all  </code></pre>
<ul>
<li>Switch to a different target using <strong>systemctl isolate</strong></li>
</ul>
<pre><code>[root@host ~]# systemctl isolate multi-user.target</code></pre>
<p><em>Isolating a target stops all services not required by that target (and its dependencies), and starts any required services not yet started</em></p>
<ul>
<li>Get the default target</li>
</ul>
<pre><code>[root@host ~]# systemctl get-default</code></pre>
<ul>
<li>Setting a Default Target</li>
</ul>
<pre><code>[root@host ~]# systemctl set-default graphical.target</code></pre>
<ul>
<li>To select a different target at boot time
<ol style="list-style-type: decimal">
<li>Boot the system</li>
<li>Interrupt the boot loader</li>
<li>Move cursor to kernel entry</li>
<li>Press <strong>e</strong> to edit</li>
<li>Move the cursos to the line that starts with <strong>linux</strong></li>
<li>append the option for instance <strong>systemd.unit=emergency.target</strong></li>
<li>Ctrl+x to boot with changes</li>
</ol></li>
</ul>
</div>
<div id="resetting-the-root-password" class="section level3">
<h3><span class="header-section-number">3.10.2</span> Resetting the Root Password</h3>
<p><strong>Option 1</strong></p>
<ul>
<li>Boot the system using a Live CD</li>
<li>Mount the root file system</li>
<li>Edit <strong>/etc/shadow</strong></li>
</ul>
<p><strong>Option 2</strong></p>
<ul>
<li>Reboot the system</li>
<li>Interrupt the boot loader</li>
<li>Move the cursor to the kernel</li>
<li>Press <strong>e</strong> to edit</li>
<li>Move the cursor to kernel command line, starting with <strong>linux</strong></li>
<li>Append <strong>rd.break</strong></li>
<li>Press Ctrl+x to boot</li>
<li>System will presents a root shell</li>
<li>Change the root file system to read/write <code>switch_root:/# mount -o remount,rw /sysroot</code></li>
<li>Switch into a <strong>chroot</strong> <code>switch_root:/# chroot /sysroot</code></li>
<li>Set the new PWD <code>passwd root</code></li>
<li>run <code>sh-4.4# touch /.autorelabel</code> to include <strong>/etc/shadow</strong></li>
<li>Exit to system continue the boot</li>
</ul>
<p><strong>Option 3</strong></p>
<ul>
<li>Reboot the system</li>
<li>Interrupt the boot loader</li>
<li>Move the cursor to the kernel</li>
<li>Press <strong>e</strong> to edit</li>
<li>Move the cursor to kernel command line, starting with <strong>linux</strong></li>
<li>Enable the debug using <code>systemctl enable debug-shell.service</code> or during boot <code>systemd.unit=debig.target</code></li>
<li>Append <code>systemd.unit=rescue.target</code> or <code>systemd.unit=emergency.target</code>
<ul>
<li>Emergency keep the root file system as read only, remount as read write <code>mount -o remount,rw /</code></li>
</ul></li>
<li>Change the password</li>
<li>Remove the debug <code>systemctl stop debug-shell.service,</code></li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r124.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-RH134.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
